<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Личный кабинет</title>
    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        height: 100%;
        font-family: "SF Pro Text", Helvetica, Arial, sans-serif;
        font-size: 16px;
        line-height: 1.5;
        color: #131313;
        -webkit-font-smoothing: antialiased;
        box-sizing: border-box;
      }

      .container {
        max-width: 600px;
        margin: 0 auto;
        padding: 16px;
        padding-bottom: 80px;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 32px;
      }

      .header__title {
        font-size: 32px;
        font-weight: 500;
        text-align: center;
        flex-grow: 1;
      }

      .button-icon {
        background: none;
        border: none;
        padding: 8px;
        cursor: pointer;
        border-radius: 50%;
      }

      .button-icon img {
        width: 16px;
        height: 16px;
      }

      .profile {
        display: flex;
        align-items: center;
        margin-bottom: 24px;
      }

      .profile__image {
        width: 54px;
        height: 54px;
        border-radius: 50%;
        object-fit: cover;
        margin-right: 12px;
      }

      .profile__info {
        flex-grow: 1;
      }

      .profile__name {
        font-size: 20px;
        font-weight: 400;
        margin-bottom: 8px;
      }

      .profile__phone {
        font-size: 14px;
        color: #545454;
      }

      .small-button {
        padding: 8px 12px;
        border: 1px solid #131313;
        border-radius: 12px;
        background: none;
        font-size: 16px;
        font-weight: 500;
        cursor: pointer;
      }

      .setting {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
      }

      .setting__label {
        font-size: 16px;
      }

      .switch {
        position: relative;
        display: inline-block;
        width: 48px;
        height: 24px;
      }

      .switch input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #a368f0;
        transition: 0.4s;
        border-radius: 34px;
      }

      .slider:before {
        position: absolute;
        content: "";
        height: 20px;
        width: 20px;
        left: 2px;
        bottom: 2px;
        background-color: #fbfbfb;
        transition: 0.4s;
        border-radius: 50%;
      }

      input:checked + .slider:before {
        transform: translateX(24px);
      }

      .tags {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 24px;
      }

      .tag {
        background-color: #a368f0;
        color: #fbfbfb;
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 14px;
      }

      .link-button {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
        padding: 0;
        background: none;
        border: none;
        font-size: 16px;
        font-weight: 500;
        cursor: pointer;
        text-align: left;
        text-decoration: none; /* Убираем подчеркивание */
        color: inherit; /* Наследуем цвет текста */
      }

      .logout-button {
        color: #545454;
        margin-top: 56px;
      }

      .tab-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px;
        background-color: #fafafaa3;
        border-radius: 32px;
        position: fixed;
        bottom: 16px;
        left: 16px;
        right: 16px;
        z-index: 1000;
        backdrop-filter: blur(10px);
      }

      .tab-item {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 12px;
        border-radius: 999px;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      .tab-item:hover {
        background-color: rgba(0, 0, 0, 0.05);
      }

      .tab-item img {
        width: 16px;
        height: 16px;
      }

      .tab-item.active {
        background-color: #a368f0;
      }

      .tab-item.active img {
        filter: brightness(0) invert(1);
      }

      .spacer {
        width: 36px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header class="header">
        <a href="main.html" class="button-icon" aria-label="Назад">
            <img src="img/backstep.png" alt="Назад" width="16" height="16" />
        </a>
        <h1 class="header__title">Личный кабинет</h1>
      </header>
      <main>
        <section class="profile">
          <img class="profile__image" src="img/user.png" alt="Фото профиля" />
          <div class="profile__info">
            <h2 class="profile__name">Дарья</h2>
            <p class="profile__phone">+7 982 912 87 35</p>
          </div>
          <button class="small-button">Изменить</button>
        </section>
        <section class="setting">
          <span class="setting__label">Уведомления</span>
          <label class="switch">
            <input type="checkbox" checked />
            <span class="slider"></span>
          </label>
        </section>
        <section class="setting">
          <span class="setting__label">Язык</span>
          <span>Русский</span>
        </section>
        <a href="history_of_analysis.html" class="link-button">
            История анализа
            <img src="img/nextstep.png" alt="Перейти" />
        </a>
        <section>
          <h3>Реакции (1):</h3>
          <button class="small-button">Редактировать</button>
          <div class="tags">
            <span class="tag">Аллергия</span>
          </div>
        </section>
        <section>
          <h3>Аллергены (8):</h3>
          <button class="small-button">Редактировать</button>
          <div class="tags">
            <span class="tag">Парабены</span>
            <span class="tag">Красители</span>
            <span class="tag">Ароматизаторы</span>
            <span class="tag">Протеины</span>
            <span class="tag">Фотосенсибилизаторы</span>
            <span class="tag">Эфирные масла</span>
            <span class="tag">Сульфаты</span>
            <span class="tag">Алкоголь</span>
          </div>
        </section>
        <a href="support.html" class="link-button">
            Справка и поддержка
            <img src="img/nextstep.png" alt="Перейти" />
        </a>
        <button class="link-button logout-button">
            Выйти
            <img src="img/upload-finder.svg" alt="Выйти" />
        </button>
      </main>
    </div>
    <!-- Нижнее меню с 5 кнопками -->
    <nav class="tab-bar" role="navigation">
        <a href="main.html" class="tab-item" aria-label="Home">
            <img src="img/main.png" alt="Главная" aria-hidden="true"/>
        </a>
        <span class="spacer"></span>
    
        <a href="experts.html" class="tab-item" aria-label="Chat">
            <img src="img/chat.png" alt="Чат" aria-hidden="true"/>
        </a>
        <span class="spacer"></span>
    
        <a href="analyse.html" class="tab-item" aria-label="Analyse">
            <img src="img/code.png" alt="Анализ" aria-hidden="true"/>
        </a>
        <span class="spacer"></span>
    
        <a href="favourites.html" class="tab-item" aria-label="Favorites">
            <img src="img/favourite.png" alt="Избранное" aria-hidden="true"/>
        </a>
        <span class="spacer"></span>
    
        <a href="personal_account.html" class="tab-item" aria-label="Profile">
            <img src="img/user.png" alt="Профиль" aria-hidden="true"/>
        </a>
    </nav>
    <script>
  document.addEventListener('DOMContentLoaded', function() {
    // Проверяем, прошел ли пользователь регистрацию
    if (!localStorage.getItem('userName')) {
      window.location.href = 'registration.html';
      return;
    }

    // Устанавливаем данные пользователя
    const userName = localStorage.getItem('userName') || 'Гость';
    const userPhone = localStorage.getItem('userPhone') || '+7 XXX XXX XX XX';
    
    const profileNameElement = document.querySelector('.profile__name');
    const profilePhoneElement = document.querySelector('.profile__phone');
    
    if (profileNameElement) profileNameElement.textContent = userName;
    if (profilePhoneElement) profilePhoneElement.textContent = userPhone;

    // Обработчик кнопки "Изменить"
    const editButton = document.querySelector('.profile .small-button');
    if (editButton) {
      editButton.addEventListener('click', function() {
        const newName = prompt('Введите новое имя:', userName);
        if (newName && newName.trim() !== '') {
          localStorage.setItem('userName', newName.trim());
          profileNameElement.textContent = newName.trim();
          
          // Обновляем имя на главной странице (если она открыта)
          if (window.opener) {
            window.opener.updateUserName(newName.trim());
          }
        }
      });
    }

    // Обработчик кнопки "Выйти"
    const logoutButton = document.querySelector('.logout-button');
    if (logoutButton) {
      logoutButton.addEventListener('click', function() {
        localStorage.removeItem('userName');
        localStorage.removeItem('userPhone');
        localStorage.removeItem('userConsent');
        window.location.href = 'registration.html';
      });
    }

    // Подсветка активной вкладки в меню
    const currentPage = window.location.pathname.split('/').pop();
    const menuItems = document.querySelectorAll('.tab-item');
    
    menuItems.forEach(item => {
      const itemPage = item.getAttribute('href').split('/').pop();
      if (itemPage === currentPage) {
        item.classList.add('active');
      } else {
        item.classList.remove('active');
      }
    });
  });
</script>
  </body>
</html>
